<% # Probably will break in Linux, as I think it handles newlines differently %>
<% begin %>
  <% contents_list = @textfile.contents.split("\n") %>
<% rescue ArgumentError %>
  <% contents_list = ["ERROR: invalid characters found in file.", "",
    "Ensure that the file is encoded in UTF-8."] %>
<% end %>

<%= render partial: "/shared/top", locals: {title: @textfile.name, edit: true} %>

<div id="parent">
  <div id="left">
    <% # Works magically because of views/acts_as_taggable_on/tags/_tag.html.erb %>
    <% # See: github.com/mbleigh/acts-as-taggable-on/wiki/Tutorial-for-Posts %>
    <p class="main_text"><b>Tags:</b> <%= render @textfile.tags %></p>
    <p class="main_text"><b>Location:</b> <%= @textfile.location %></p>
    <hr>
    <p class="main_text">
      <% contents_list.each do |line| %>
        <%= line %><br>
      <% end %>
    </p>
    <p class="nav_link"><%= link_to("Return to all files", user_path(@user)) %></p>
  </div>
  <%= render partial: "/shared/tags", locals: {tags: @tags} %>
</div>
